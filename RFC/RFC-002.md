# RFC-002 - Building and property certificates

Councils are responsible for issuing building and property certificates. These are issued against parcels that are identified via Lot, Section and Deposited Plans (DP).

The value of this module is in two parts:

- The ability to place orders for certificates for a valid property
- The ability to fulfill orders for certificates by following a workflow informed by the customer

## Property files

Property information is stored in a council's rating system. There are a few major players in the ERP market for local government. Integration with these systems are difficult due to:

- Resistance from the providers to integrate third party systems
- Systems being on premise and don't have cloud connectors
- Allowing any property planning system to integrate with the building and property ordering system

Property data is loaded in via a CSV file upload (this can be an API call for councils that are that way inclined). The CSV file contains the following columns:

- Lot
- Section
- DP
- Address
- Suburb
- Postcode
- Owner

The CSV file is uploaded to the system and the system will validate the data. If the data is valid, the system will create a property record for each row in the CSV file. If the data is invalid, the system will return an error message to the user.

Each upload creates a new version of the property records. Once the upload is successful an admin user is able to activate the new version.

Note that because orders are placed against a Lot, Section, DP combination, storing relationships to that data is not relevant.

## Ordering lifecycle

The user does not require an account on the system to place and order for certificates.

## Technical requirements

We should handle Stripe webhooks to keep the information in sync with the payment gateway. These include information such as payout status, charge status, etc.

Each customer should be provisioned as a Stripe customer. Anomaly projects use a two way sync mechanism with Stripe to leverage the platform.

Note that [Stripe has detailed](https://docs.stripe.com/webhooks) specifications on how to handle the security of messages being delivered via Webhooks.

## Fulfillment lifecycle

## Administrative functions

### Uploading property data

### User management

### Financial reporting

## Technology

Delivery of the module will be as a containerised application. We should provide as much flexibility as possible to ensure that customers with simple workloads don't have to run complex infrastructure. We recommend that we provide templates for the following:

- Kubernetes
- Docker compose?

Anomaly maintains a [AWS Terraform template](https://github.com/anomaly/aws-eks-cluster) which can be used to deploy Django applications in an EKS cluster.

Payments are handled using Stripe, for the purposes of shipping the module we will limit to using Stripe for payments. Extending to other payment gateways wil be outside the scope of the initial development.
